{% extends 'base.html' %}
{% block title %}Historial{% endblock %}
{% block content %}
<h1 class="mb-4">Historial de Problemas</h1>
<form method="get" class="mb-3 d-flex align-items-center">
  <label for="orden" class="me-2">Ordenar por:</label>
  <select id="orden" name="orden" class="form-select w-auto" onchange="this.form.submit()">
    <option value="asc" {% if orden == 'asc' %}selected{% endif %}>Primeros agregados</option>
    <option value="desc" {% if orden == 'desc' %}selected{% endif %}>Últimos agregados</option>
  </select>
</form>
{% if problemas %}
<table class="table">
  <thead>
    <tr>
      <th>#</th>
      <th>Objetivo</th>
      <th>Función Objetivo</th>
      <th>Restricciones</th>
      <th>Fecha</th>
      <th>Ir al problema</th>
    </tr>
  </thead>
  <tbody>
  {% for p in problemas %}
    <tr>
      <td>{{ p.numero }}</td>
      <td>{{ p.get_objetivo_display }}</td>
      <td>Z = {{ p.coef_x1 }}x₁ {% if p.coef_x2 >= 0 %}+{% endif %}{{ p.coef_x2 }}x₂</td>
      <td>
        {% for r in p.restricciones %}
          {{ r.coef_x1 }}x₁ {% if r.coef_x2 >= 0 %}+{% endif %}{{ r.coef_x2 }}x₂ {{ r.operador }} {{ r.valor }}<br>
        {% endfor %}
      </td>
      <td>{{ p.created_at|date:'Y-m-d H:i' }}</td>
      <td><a class="btn btn-sm btn-primary" href="{% url 'ver_problema' p.id %}">Ver</a></td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% else %}
<p>No hay problemas guardados.</p>
{% endif %}
{% endblock %}
